
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link rel="top" title="Home" href="http://www.mozilla.org/">
<link rel="stylesheet" type="text/css" href="../../../../../../css/print.css"  media="print">
<link rel="stylesheet" type="text/css" href="../../../../../../css/base/content.css"  media="all">
<link rel="stylesheet" type="text/css" href="../../../../../../css/cavendish/content.css" title="Cavendish" media="screen">
<link rel="stylesheet" type="text/css" href="../../../../../../css/base/template.css"  media="screen">
<link rel="stylesheet" type="text/css" href="../../../../../../css/cavendish/template.css" title="Cavendish" media="screen">
<link rel="icon" href="../../../../../../images/mozilla-16.png" type="image/png">

<TITLE>Getting Started With SSL
</TITLE>
<script src="../../../../../../__utm.js" type="text/javascript"></script>
</head>
<body id="www-mozilla-org" class="deepLevel">
<div id="container">
<p class="important">You are currently viewing a snapshot of www.mozilla.org taken on April 21, 2008. Most of this content is
highly out of date (some pages haven't been updated since the project began in 1998) and exists for historical purposes only.  If
there are any pages on this archive site that you think should be added back to www.mozilla.org, please <a
href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=www.mozilla.org">file a bug</a>.</p>
<p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>
<div id="header">
<h1><a href="/" title="Return to home page" accesskey="1">Mozilla</a></h1>
<ul>
<li id="menu_aboutus"><a href="../../../../../../about/" title="Getting the most out of your online experience">About</a></li>
<li id="menu_developers"><a href="../../../../../../developer/" title="Using Mozilla's products for your own applications">Developers</a></li>
<li id="menu_store"><a href="http://store.mozilla.org/?r=mozorg1" title="Shop for Mozilla products on CD and other merchandise">Store</a></li>
<li id="menu_support"><a href="../../../../../../support/" title="Installation, trouble-shooting, and the knowledge base">Support</a></li>
<li id="menu_products"><a href="../../../../../../products/" title="All software Mozilla currently offers">Products</a></li>
</ul>
<form id="searchbox_002443141534113389537:ysdmevkkknw" action="http://www.google.com/cse" title="mozilla.org Search">
<div>
<label for="q" title="Search mozilla.org's sites">search mozilla:</label>
<input type="hidden" name="cx" value="002443141534113389537:ysdmevkkknw">
<input type="hidden" name="cof" value="FORID:0">
<input type="text" id="q" name="q" accesskey="s" size="30">
<input type="submit" id="submit" value="Go">
</div>
</form>
</div>
<hr class="hide">
<div id="mBody">
<div id="side">

<ul id="nav">
<li><a title="Roadmap" href="../../../../../../roadmap.html"><strong> Roadmap</strong></a></li>
<li><a title="Projects" href="../../../../../../projects/"><strong> Projects</strong></a></li>
<li><a title="For developers" href="../../../../../../developer/"><strong> Coding</strong></a>
<ul>
<li><a title="Module Owners" href="../../../../../../owners.html"> Module Owners</a></li>
<li><a title="Hacking" href="../../../../../../hacking/"> Hacking</a></li>
<li><a title="Get the Source" href="http://developer.mozilla.org/en/docs/Download_Mozilla_Source_Code"> Get the Source</a></li>
<li><a title="Building Mozilla" href="http://developer.mozilla.org/en/docs/Build_Documentation"> Build It</a></li>
</ul>
</li>
<li><a title="Testing" href="../../../../../../quality/"><strong> Testing</strong></a>
<ul>
<li><a title="Downloads of mozilla.org software releases" href="../../../../../../download.html"> Releases</a></li>
<li><a title="Latest mozilla builds for testers" href="../../../../../../developer/#builds"> Nightly Builds</a></li>
<li><a title="For testers to report bugs" href="https://bugzilla.mozilla.org/"> Report A Problem</a></li>
</ul>
</li>
<li><a title="Tools for mozilla developers" href="../../../../../../tools.html"><strong> Tools</strong></a>
<ul>
<li><a title="Bug tracking system for mozilla testers." href="https://bugzilla.mozilla.org/"> Bugzilla</a></li>
<li><a title="Latest status of mozilla builds" href="http://tinderbox.mozilla.org/showbuilds.cgi?tree=Firefox"> Tinderbox</a></li>
<li><a title="Latest checkins" href="http://bonsai.mozilla.org/cvsqueryform.cgi"> Bonsai</a></li>
<li><a title="Source cross reference" href="http://lxr.mozilla.org/seamonkey/"> LXR</a></li>
</ul>
</li>
<li><a title="Frequently Asked Questions." href="../../../../../../faq.html"><strong> FAQs</strong></a></li>
</ul>

</div>
<hr class="hide">
<div id="mainContent">





<FONT SIZE=-1><A HREF="index.html">Table of Contents</A> | <A HREF="sslintro.html">Previous</A>
 | <A HREF="ssltyp.html">Next</A>
 | <A HREF="bklast.html">Index</A>
</FONT><BR><BR>


<BR>
<HR>
<A NAME="1014942">
<P></A><CENTER><H2>Chapter 2<BR>
<A NAME="1005439">
Getting Started With SSL</A></H2></CENTER>
<A NAME="1006945">
This chapter describes how to set up your environment, including certificate and key databases, to run the NSS sample code. The sample code and makefiles are available via LXR in the <A HREF="http://lxr.mozilla.org/mozilla/source/security/nss/cmd/SSLsample/">SSLSamples</A> directory.</A></P>
<A NAME="1013252">
<A HREF="gtstd.html#1011970">SSL, PKCS #11, and the Default Security Databases</A><br><A HREF="gtstd.html#1011987">Setting Up the Certificate and Key Databases</A><br><A HREF="gtstd.html#1013274">Building NSS Programs</A></A></P>
<BLOCKQUOTE><A NAME="1016303"><B>Important
 </B></A>
<A NAME="1016325">
This chapter refers in several places to a tool called Key Database Tool, or 
<CODE>keyutil</CODE>. The capabilities of <CODE>keyutil</CODE> have been folded into the tool called 
Certificate Database Tool, or <CODE>certutil</CODE>. The samples given in this chapter are 
therefore out of date.
</A>
</BLOCKQUOTE>

<H2><A NAME="SSL, PKCS #11, and the Default Security Databases"></A>
<A NAME="1011970">
 SSL, PKCS #11, and the Default Security Databases
</A></H2><A NAME="1011984">
The basic relationships among the NSS libraries are described in <A HREF="../../intro.html">Introduction to Network Security Services</A>. Before running the sample programs, it's important to understand the relationships between the SSL interface, the PKCS #11 interface, PKCS #11 modules, and the default Netscape security databases.</A></P>
<A NAME="1013023">
A <B>PKCS #11 module</B> (also called a <B>cryptographic module</B>) manages cryptographic services such as encryption and decryption via the PKCS #11 interface. PKCS #11 modules can be thought of as drivers for cryptographic devices that can be implemented in either hardware or software. Netscape provides a built-in PKCS #11 module with NSS. Other kinds of PKCS #11 modules include the Netscape FORTEZZA module, used by the government, and the Litronic PKCS #11 module for smart card readers.</A></P>
<A NAME="1013148">
<A HREF="gtstd.html#1013181">Figure 2.1</A> illustrates the relationships between NSPR, SSL, PKCS #11, and the available cryptographic modules. SSL is built on top of NSPR, which handles sockets, threads, and related low-level OS operations. On any given server or client, one or more PKCS #11 modules may be available.</A></P>
<P><A NAME="1013181">
<B>Figure 2.1&nbsp;&nbsp;&nbsp;  Relationships among NSS libraries, cryptographic modules, slots, and tokens<P>
<IMG SRC="pkcs.gif">

</B></A></P>


<A NAME="1015314">
As shown in the figure, SSL communicates with PKCS #11 modules through the PKCS #11 interface. Any PKCS #11 module that supports PKCS #11 can be used with the NSS libraries. Netscape software uses a file called <CODE>secmod.db</CODE> to keep track of the modules available. </A></P>
<A NAME="1013163">
A PKCS #11 module always has one or more <B>slots,</B> which may be implemented as physical hardware slots in some form of physical reader (for example, for smart cards) or as conceptual slots in software. Each slot for a PKCS #11 module can in turn contain a <B>token,</B> which is the hardware or software device that actually provides cryptographic services and optionally stores certificates and keys. </A></P>
<A NAME="1013114">
Netscape provides three built-in modules with NSS and with server and client products:</A></P>
<ul><P><LI><A NAME="1015629">
The default Netscape Internal PKCS #11 Module comes with two built-in tokens:</A></LI>
<ul>
</P><LI><A NAME="1015242">
The Generic Crypto Services token performs all cryptographic operations, such as encryption, decryption, and hashing.</A></LI>
</P><LI><A NAME="1015250">
The Communicator Certificate DB token handles all communication with the certificate and key database files (called <CODE>cert</CODE><I>X</I><CODE>.db</CODE> and <CODE>key</CODE><I>X</I><CODE>.db</CODE>, respectively, where <I>X</I> is a version number) that store certificates and keys.</A></LI>
</ul>
<P><LI><A NAME="1015663">
The FORTEZZA module is intended for use with FORTEZZA hardware tokens.</A></LI>
<P><LI><A NAME="1015439">
The FIPS 140-1 module is compliant with the FIPS 140-1 government standard for implementations of cryptographic modules. Many products sold to the U.S. government must comply with one or more of the FIPS standards. The FIPS 140-1 module includes a single, built-in FIPS 140-1 Certificate DB token (see <A HREF="gtstd.html#1013181">Figure 2.1</A>), which handles both cryptographic operations and communication with the <CODE>cert</CODE><I>X</I><CODE>.db</CODE> and <CODE>key</CODE><I>X</I><CODE>.db</CODE> files. </A></LI>
</ul><A NAME="1015492">
If you are creating a server application, you must use the Certificate Database Tool, which comes with NSS, to create the <CODE>cert</CODE><I>X</I><CODE>.db</CODE> and <CODE>key</CODE><I>X</I><CODE>.db</CODE> files and populate them with the appropriate certificates and keys. </A></P>
<A NAME="1014136">
If you are creating a client application, you can use either the Certificate Database Tool or the Communicator security interface to create the database files and populate them with the appropriate certificates and keys. You can use Communicator to set up client certificate databases by obtaining certificates from either a public CA or from a certificate server such as Netscape Certificate Management System. The instructions that follow assume you are using the Certificate Database Tool to set up both the server and client databases for testing purposes.</A></P>
<A NAME="1015405">
You can use the Security Module Database Tool, a command-line utility that comes with NSS, to manage PKCS #11 module information within s<CODE>ecmod.db</CODE> files. The Security Module Database Tool allows you to add and delete PKCS #11 modules, change passwords, set defaults, list module contents, enable or disable slots, enable or disable FIPS-140-1 compliance, and assign default providers for cryptographic operations. </A></P>

<H2><A NAME="Setting Up the Certificate and Key Databases"></A>
<A NAME="1011987">
 Setting Up the Certificate and Key Databases
</A></H2><A NAME="1011996">
Before you can run the sample programs (<CODE>server.c</CODE> and <CODE>client.c</CODE>) that come with NSS, you must set up certificate, key, and security module databases for both the client and the server and populate them with valid CA, client SSL, and server SSL certificates. The following sections decribe how to the Certificate Database Tool to perform these tasks:</A></P>
<A NAME="1013227">
<A HREF="gtstd.html#1012301">Setting Up the CA and Server Certificates</A><br><A HREF="gtstd.html#1012067">Setting Up the Client Certificate</A><br><A HREF="gtstd.html#1012108">Verifying the Server and Client Certificates</A></A></P>
<BLOCKQUOTE><B>WARNING: </B><A NAME="1012184">
The CA certificate you produce with the NSS tools is a self-signed certificate 
that works correctly for testing purposes but should not be used in a real-world 
deployment. Similarly, the client SSL and server SSL certificates created with the 
NSS tools are for testing purposes only. To deploy certificates used in a real 
public-key infrastructure (PKI), either use a third-party CA or use a certificate 
server (such as Netscape Certificate Management System) to set up your own 
CA and issue certificates. The Certificate Database Tool does not provide the 
facilities for a full-blown PKI deployment, and the certificates it creates should 
not be considered trustworthy for that purpose.
</A>
</BLOCKQUOTE>
<A NAME="1012159">
For complete information about the command-line options used in the examples that follow, see <A HREF="../../tools/certutil.html">Using the Certificate Database Tool</A>.</A></P>

<H3><A NAME="Head2;"></A>
<A NAME="1012301">
 Setting Up the CA and Server Certificates
</A></H3>

<A NAME="1012317">
The sections that follow describe how to set up the CA and server certificates:</A></P>
<A NAME="1012320">
<A HREF="gtstd.html#1012302">Creating the Databases and Generating the Keys</A><br><A HREF="gtstd.html#1012285">Creating the CA Certificate and Adding It to the Database</A><br><A HREF="gtstd.html#1012053">Creating the Server Certificate and Adding It to the Database</A></A></P>

<H4><A NAME="Head3;"></A>
<A NAME="1012302">
 Creating the Databases and Generating the Keys
</A></H4>

<A NAME="1012312">
First create the certificate and key databases for the server and generate two key pairs: one for the CA certificate and one for the server SSL certificate. </A></P>
<OL>
<P><LI><A NAME="1012356">
Create a new certificate database in the <CODE>server_db</CODE> directory.</A></LI>
<PRE><A NAME="1012008"><CODE>C:\nss11\winnt&gt;certutil -N -d server_db </CODE></A></PRE><P><LI><A NAME="1012009">
Create two key pairs in the <CODE>server_db</CODE> directory. The Certificate Database Tool automatically creates the key database and the security module database (if they don't already exist) when it creates the first key pair. </A></LI>
<PRE><A NAME="1012010"><CODE>C:\nss11\winnt&gt;keyutil -G -d server_db <br>C:\nss11\winnt&gt;keyutil -G -d server_db </CODE></A></PRE><P><LI><A NAME="1012015">
List the public keys.</A></LI>
<PRE><A NAME="1012016">C:\nss11\winnt&gt;keyutil -L -d server_db <br>Enter Password or Pin for "Communicator Certificate DB": <br>RSA Public-Key: <br>&nbsp;&nbsp;&nbsp;modulus: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;00:f7:c1:1f:a2:c1:cb:12:cc:08:91:60:48:e4:00:43:17:f1: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fc:b1:88:4b:54:47:2d:11:64:ec:c3:15:d7:5b:68:32:93:f9: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;86:71:ce:c9:cc:f0:e0:a6:28:80:86:cc:88:29:70:67:81:1d: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4f:86:04:38:52:0f:b0:aa:83:36:1b:27:06:b9:99:08:0c:3b: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d8:98:53:16:08:09:20:44:c7:8a:72:da:a2:b5:7b:71:b7:ce: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ab:48:fc:31:1e:61:09:31:0c:ef:00:05:f2:de:09:7f:f7:af: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d6:24:3e:29:09:ba:d3:98:31:12:9e:d9:b9:b4:7e:ef:01:81: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cc:92:79 </A></PRE><PRE><A NAME="1012028">RSA Public-Key: <br>&nbsp;&nbsp;&nbsp;modulus: <br>&nbsp;&nbsp;&nbsp;00:b6:2b:e8:71:6e:a5:e3:90:51:00:9d:7a:00:3b:50:eb:9e: <br>&nbsp;&nbsp;&nbsp;78:33:d8:ac:1d:95:a9:21:47:25:d0:39:ad:22:0f:d9:81:ed: <br>&nbsp;&nbsp;&nbsp;60:be:4d:db:20:f5:91:15:76:bf:5f:6c:06:aa:d1:08:8c:f9: <br>&nbsp;&nbsp;&nbsp;7c:79:b7:cd:f0:76:da:2d:5f:42:21:40:3b:92:86:b3:df:4e: <br>&nbsp;&nbsp;&nbsp;42:b8:92:18:01:91:48:c1:9d:ee:ae:03:55:c0:a1:74:69:9b: <br>&nbsp;&nbsp;&nbsp;86:f8:c0:9a:47:0a:52:30:d9:53:40:24:54:15:19:a6:92:c8: <br>&nbsp;&nbsp;&nbsp;7f:1f:3b:e4:0e:4c:09:73:ad:1e:16:00:e7:f4:3d:5f:f4:22: <br>&nbsp;&nbsp;&nbsp;f4:dd:7f </A></PRE></OL>
<A NAME="1014980">
You can identify either of the keys listed above the first few characters that are unique in the database. For example, the first key can be identified as <CODE>f7c1</CODE>.</A></P>

<H4><A NAME="Head3;"></A>
<A NAME="1012285">
 Creating the CA Certificate and Adding It to the Database
</A></H4>

<A NAME="1012549">
After the databases have been created and the key pairs generated, create the CA certificate and add it to the certificate database.</A></P>
<OL>
<P><LI><A NAME="1012039">
Create the CA certificate request, specifying the subject name for the certificate and the key <CODE>f7c1</CODE>. </A></LI>
<PRE><A NAME="1012041">C:\nss11\winnt&gt;certutil -R -s<br>"CN=myco.mcom.org,O=MyCo,ST=California,C=US" -k f7c1 -o<br>server_db\rootca.req -d server_db <br>Enter Password or Pin for "Communicator Certificate DB": </A></PRE><P><LI><A NAME="1012488">
Create a new certificate from the certificate request and self-sign it.</A></LI>
<PRE><A NAME="1012046">C:\nss11\winnt&gt;certutil -C -i server_db\rootca.req -o<br>server_db\rootca.crt -k f7c1 -x -m 1234 -d server_db <br>Enter Password or Pin for "Communicator Certificate DB": </A></PRE><P><LI><A NAME="1012049">
Add the CA certificate to the certificate database in the <CODE>server_db</CODE> directory with the appropriate trust flags and nickname.</A></LI>
<PRE><A NAME="1012050">C:\nss11\winnt&gt;certutil -A -n "MyCo's Root CA" <br>-i server_db\rootca.crt -t "CTu,CTu,CTu" -d server_db <br>Enter Password or Pin for "Communicator Certificate DB": </A></PRE></OL>
<A NAME="1012503">
The trust flag settings <CODE>"CTu,CTu,CTu"</CODE> indicate that the certificate is a CA certificate that is trusted to issue both client (<CODE>C</CODE>) and server (<CODE>T</CODE>) SSL certificates as well as email and object-signing certificates. The <CODE>u</CODE> flag indicates that the CA certificate can itself be used for signing or authentication operations.</A></P>
<BLOCKQUOTE><B>NOTE: </B><A NAME="1015153">
The <CODE>u</CODE> flag should not be set in a root CA certificate intended for deployment in 
a real (as opposed to a test) PKI for chaining purposes. Only the authorized CA 
should be able to sign anything or authenticate itself with a CA certificate.
</A>
</BLOCKQUOTE>

<H4><A NAME="Head3;"></A>
<A NAME="1012053">
 Creating the Server Certificate and Adding It to the Database
</A></H4>

<A NAME="1012054">
At this point the CA certificate has been self-signed and added to the certificate database. Next, create a server certificate signed with the CA's private key and add it to the certificate database. </A></P>
<OL>
<P><LI><A NAME="1012056">
Create the server certificate request, specifying the subject name for the certificate and the public key <CODE>b62b</CODE>. Note that the common name (CN) must be identical to the hostname of the server, or SSL server authentication will not work.</A></LI>
<PRE><A NAME="1012057">C:\nss11\winnt&gt;certutil -R -s<br>"CN=myco.mcom.org,O=MyCo,ST=California,C=US" -k b62b -o<br>server_db\server.req -d server_db <br>Enter Password or Pin for "Communicator Certificate DB": </A></PRE><P><LI><A NAME="1012060">
Create a new server certificate from the certificate request and sign it with the CA's private key.</A></LI>
<PRE><A NAME="1012061">C:\nss11\winnt&gt;certutil -C -c "MyCo's Root CA" <br>-i server_db\server.req -o server_db\server.crt -m 1222 -d server_db <br>Enter Password or Pin for "Communicator Certificate DB": </A></PRE><P><LI><A NAME="1012064">
Add the new server certificate to the certificate database in the <CODE>server_db</CODE> directory with the appropriate trust flags and nickname.</A></LI>
<PRE><A NAME="1012065">C:\nss11\winnt&gt;certutil -A -n myco.mcom.org <br>-i server_db\server.crt -t "u,u,u" -d server_db <br>Enter Password or Pin for "Communicator Certificate DB": </A></PRE></OL>
<A NAME="1012604">
The trust flag settings <CODE>"u,u,u"</CODE> indicate that the certificate can be used for authentication or signing as an SSL certificate, an email certificate, or an object-signing certificate.</A></P>

<H3><A NAME="Head2;"></A>
<A NAME="1012067">
 Setting Up the Client Certificate
</A></H3>

<A NAME="1012786">
Setting up the client certificate database involves three stages:</A></P>
<A NAME="1012625">
<A HREF="gtstd.html#1012305">Creating the Databases and Generating the Keys</A><br><A HREF="gtstd.html#1012671">Creating the Client Certificate and Adding It to the Database</A><br><A HREF="gtstd.html#1012099">Adding the CA Certificate to the Database</A></A></P>

<H4><A NAME="Head3;"></A>
<A NAME="1012305">
 Creating the Databases and Generating the Keys
</A></H4>

<A NAME="1012068">
The first step in setting up the client certificate is to create the certificate and key databases for the client and generate a key pair. </A></P>
<OL>
<P><LI><A NAME="1012069">
Create a new certificate database in the <CODE>client_db</CODE> directory.</A></LI>
<PRE><A NAME="1012070">C:\nss11\winnt&gt;certutil -N -d client_db </A></PRE><P><LI><A NAME="1012071">
Create two key pairs in the <CODE>client_db</CODE> directory. The Certificate Database Tool automatically creates the key database directory when it creates the first key pair.</A></LI>
<PRE><A NAME="1012072">C:\nss11\winnt&gt;keyutil -G -d client_db </A></PRE><P><LI><A NAME="1012073">
List the public key.</A></LI>
<PRE><A NAME="1012661">C:\nss11\winnt&gt;keyutil -L -d client_db <br>Enter Password or Pin for "Communicator Certificate DB": <br>RSA Public-Key: <br><CODE>&nbsp;&nbsp;&nbsp;modulus: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;00:d8:7e:3c:5b:26:9a:d5:77:69:7d:b8:b0:ce:6d:1e:fe:f6: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;82:f9:b4:4b:4d:76:26:8b:e2:a4:fc:01:99:11:22:3f:21:0f: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;85:26:d3:cd:4c:94:1f:a8:81:26:af:1b:08:41:4f:7f:4d:ad: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2f:c5:c5:4a:c2:41:1d:71:80:1c:4f:91:80:ae:e2:29:ab:a8: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1d:06:d1:f8:a9:1a:63:5f:09:cb:65:a5:a1:a4:8a:dc:29:5f: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;85:d7:fc:3c:8e:64:ea:f5:a8:d7:12:d3:03:18:1b:54:24:1e: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7d:86:00:6d:b6:d8:80:c1:a7:98:8f:7e:f3:16:70:3f:bc:0f: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5e:56:c5</CODE> </A></PRE></OL>

<H4><A NAME="Head3;"></A>
<A NAME="1012671">
 Creating the Client Certificate and Adding It to the Database
</A></H4>

<A NAME="1012725">
After the databases have been created and the key pair generated, create the client certificate and add it to the certificate database.</A></P>
<OL>
<P><LI><A NAME="1012736">
Create the client certificate request, specifying the subject name for the certificate and the key <CODE>d87e</CODE>.</A></LI>
<PRE><A NAME="1012087">C:\nss11\winnt&gt;certutil -R -s<br>"CN=myco.mcom.org,O=MyCo,ST=California,C=US" -k d87e -o<br>client_db\client.req -d client_db <br>Enter Password or Pin for "Communicator Certificate DB": </A></PRE><P><LI><A NAME="1012090">
Create a new certificate from the certificate request and sign it with the CA's private key. Note that this key resides in the key database located in the directory <CODE>server_db</CODE>, as specified for the <CODE>-d</CODE> option. (This step assumes that the client certificate is being created on the same machine on which you created the server and CA certificates.)</A></LI>
<PRE><A NAME="1012091">C:\nss11\winnt&gt;certutil -C -c "MyCo's Root CA" <br>-i client_db\client.req -o client_db\client.crt -m 3434 -d server_db <br>Enter Password or Pin for "Communicator Certificate DB": </A></PRE><P><LI><A NAME="1012094">
Add the new server certificate to the certificate database in the <CODE>client_db</CODE> directory with the appropriate trust flags and nickname.</A></LI>
<PRE><A NAME="1012097">C:\nss11\winnt&gt;certutil -A -n myco.mcom.org <br>-i client_db\client.crt -t "u,u,u" -d client_db <br>Enter Password or Pin for "Communicator Certificate DB": </A></PRE></OL>

<H4><A NAME="Head3;"></A>
<A NAME="1012099">
 Adding the CA Certificate to the Database
</A></H4>

<A NAME="1012100">
The last step is to add the CA certificate to the client database so that the client can authenticate the server's certificate. </A></P>
<ul><P><LI><A NAME="1012102">
Add the CA certificate to the certificate database in the <CODE>client_db</CODE> directory with the appropriate trust flags and nickname.</A></LI>
<PRE><A NAME="1012103">C:\nss11\winnt&gt;certutil -A -n "MyCo's Root CA" <br>-i server_db\rootca.crt -t "CT,CT,CT" -d client_db <br>Enter Password or Pin for "Communicator Certificate DB": </A></PRE></ul><BLOCKQUOTE><B>NOTE: </B><A NAME="1015182">
The <CODE>u</CODE> flags should not be set in a root CA certificate intended for deployment 
in a real PKI for chaining purposes. Only the authorized CA should be able to 
sign anything or authenticate itself with a CA certificate. 
</A>
</BLOCKQUOTE>

<H3><A NAME="Head2;"></A>
<A NAME="1012108">
 Verifying the Server and Client Certificates
</A></H3>

<A NAME="1012833">
When you have finished setting up the server and client certificate databases, verify that the client and server certificates are valid, as follows:</A></P>
<PRE><A NAME="1012109">C:\nss11\winnt&gt;certutil -V -u V -n myco.mcom.org -d server_db <br>Certificate:'myco.mcom.org' is valid! </A></PRE><PRE><A NAME="1012112">C:\nss11\winnt&gt;certutil -V -u C -n myco.mcom.org -d client_db <br>Certificate:'myco.mcom.org' is valid! </A></PRE>
<H2><A NAME="Building NSS Programs"></A>
<A NAME="1013274">
 Building NSS Programs
</A></H2><A NAME="1013279">
The <A HREF="http://lxr.mozilla.org/mozilla/source/security/nss/cmd/SSLsample/">SSLSamples</A> directory includes sample makefiles for building the sample programs. On Unix, use the GNU utility <CODE>gmake</CODE> to run the makefile. On Windows NT, use the <CODE>nmake</CODE> utility that comes with Visual C++.</A></P>
<A NAME="1013292">
If you create your own makefiles, be sure to include the libraries in the same order that they are listed in the sample makefiles. In addition, you must use the following compiler flags:</A></P>
<A NAME="1013307">
Solaris flags: </A></P>
<PRE><A NAME="1013308">-c -O -KPIC -DSVR4 -DSYSV -D__svr4 -D__svr4__ <br>-DSOLARIS -D_REENTRANT -DSOLARIS2_5 -D_SVID_GETTOD <br>-DXP_UNIX -UDEBUG -DNDEBUG </A></PRE><A NAME="1013309">
Windows NT flags: </A></P>
<PRE><A NAME="1013310">-c -O2 -MD -W3 -nologo -D_X86_ -GT <br>-DWINNT -DXP_PC -UDEBUG -U_DEBUG -DNDEBUG <br>-DWIN32 -D_WINDOWS </A></PRE><PRE><A NAME="1013272"></A></PRE>
<HR>

<FONT SIZE=-1><A HREF="index.html">Table of Contents</A> | <A HREF="sslintro.html">Previous</A>
 | <A HREF="ssltyp.html">Next</A>
 | <A HREF="bklast.html">Index</A>
</FONT>
<P ALIGN=right>
<FONT SIZE=-2><I>Last Updated:  10/18/00  09:17:42</I></FONT>
<P> 





<hr class="hide">
</div>
</div>
<div id="footer">
<ul>
<li><a href="../../../../../../sitemap.html">Site Map</a></li>
<li><a href="../../../../../../security/">Security Updates</a></li>
<li><a href="../../../../../../contact/">Contact Us</a></li>
<li><a href="../../../../../../foundation/donate.html">Donate</a></li>
</ul>
<p class="copyright">
Portions of this content are &copy; 1998&#8211;2009 by individual mozilla.org
contributors; content available under a Creative Commons license | <a
href="http://www.mozilla.org/foundation/licensing/website-content.html">Details</a>.</p>
<p>
<span>Last modified October  1,  2007</span>
<span><a href="http://bonsai-www.mozilla.org/cvslog.cgi?file=mozilla-org/html/projects/security/pki/nss/ref/ssl/gtstd.html&amp;rev=&amp;root=/www/">Document History</a></span>
</p>
</div>
</div>
</body>
</html>
