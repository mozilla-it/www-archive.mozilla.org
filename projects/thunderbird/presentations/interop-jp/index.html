<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<title>Mozilla Technologies</title>
<!-- metadata -->
<meta name="generator" content="S5" />
<meta name="version" content="S5 1.2a2" />
<meta name="author" content="Scott MacGregor" />
<meta name="company" content="Mozilla Corporation" />
<meta name="presdate" content="6/07/2006" />

<!-- configuration parameters -->
<meta name="defaultView" content="slideshow" />
<meta name="controlVis" content="hidden" />

<!-- style sheet links -->
<link rel="stylesheet" href="ui/default/slides.css" type="text/css" media="projection" id="slideProj" />
<link rel="stylesheet" href="ui/pretty.css" type="text/css" media="screen" id="prettyStyle" />
<link rel="stylesheet" href="ui/default/outline.css" type="text/css" media="screen" id="outlineStyle" />
<link rel="stylesheet" href="ui/default/print.css" type="text/css" media="print" id="slidePrint" />
<link rel="stylesheet" href="ui/default/opera.css" type="text/css" media="projection" id="operaFix" />

<!-- embedded styles -->
<style type="text/css" media="all">
.imgcon {width: 525px; margin: 0 auto; padding: 0; text-align: center;}
#anim {width: 270px; height: 320px; position: relative; margin-top: 0.5em;}
#anim img {position: absolute; top: 42px; left: 24px;}
img#me01 {top: 0; left: 0;}
img#me02 {left: 23px;}
img#me04 {top: 44px;}
img#me05 {top: 43px;left: 36px;}
table.listtable td {
      border-top: 1px solid #333;
      padding-left: 10px;
      padding-right: 10px;
}
</style>

<!-- S5 JS -->
<script src="ui/default/slides.js" type="text/javascript"></script>

<!-- Page JS -->
<script src="demo.js" type="text/javascript"></script>

</head>
  <body>
    <div class="layout">
      <div id="controls"><!-- DO NOT EDIT --></div>
      <div id="currentSlide"><!-- DO NOT EDIT --></div>
      <div id="header"></div>
      <div id="footer">
	      <h1>Interop Tokyo 2006</h1>
      </div>
    </div>

    <div class="presentation">
      
<div class="slide">
<h1>Mozilla Technologies</h1>
<h3>Scott MacGregor</h3>
<h4><a href="http://www.mozilla.com/">Mozilla Corporation</a></h4>
</div>

<!--
<div class="slide">
<h1>What is Mozilla?</h1>
<ul>
<li>Consumer Products: Firefox and Thunderbird</li>
<li>Browser for small devices: Minimo</li>
<li>Platform for Extension Authors</li>
<li>Platform for Building Applications (XUL Runner)</li>
</ul>

(replace these bullets with a graphic?)

</div>

<div class="slide">
<h1>Firefox</h1>
<ul>
<li>Premier open source browser</li>
<li>Safe Browsing: Protects you from viruses, spyware and pop-ups</li>
<li>Tab Browsing, Live Bookmarks, Automatic Software Update</li>
<li>Download Numbers / Statistics</li>
<li>Rich standards support empowering Web 2.0</li>
</ul>

(Firefox logo and/or screen shot)
</div>

<div class="slide">
<h1>Firefox 2</h1>
<ul>
<li>Late Summer 2006</li>
<li>Improved Support for RSS Feed Handling</li>
<li>Improved Extension Manager</li>
<li>Microsummaries</li>
<li>Phishing Detector</li>

(screen shot of microsummaries)
</ul>
</div>

<div class="slide">
<h1>Firefox 3</h1>
<ul>
<li>Parallel development with Firefox 2</li>
<li>Release Date: 2007</li>
<li>Advanced Graphics Support (Cairo)</li>
<li>New Bookmarks Manager: Places</li>
<li>SVG and Canvas</li>
</div>

<div class="slide">
<h1>Thunderbird</h1>
<ul>
<li>Open source mail client for consumers and enterprises</li>
<li>IMAP, POP, SMTP, LDAP, SMIME</li>
<li>Builtin SPAM and Anti-Phishing</li>
<li>Available in over 30 languages on Mac, Windows and Linux</li>
<li>Download Numbers / Users</li>

(screen shot of mail 3-pane)
</ul>
</div>

<div class="slide">
<h1>Thunderbird 2</h1>
<ul>
<li>Late Fall 2006</li>
<li>Goals</li>
<li>Folder Pane Views, Favorite Folders</li>
<li>Message Tagging</li>
<li>Improved new mail alerts</li>
<li>Anti-Phishing Improvements</li>

(screen shot of new mail alerts, maybe favorite folders)
</ul>
</div>

<div class="slide">
<h1>Minimo</h1>
<table>
<tr>
<td>
<ul>
<li>Same Safe, Secure Mozilla Browser but for small devices</li>
<li>Windows Mobile (Windows CE, Pocket PC)</li>
<li>Low memory and disk space requirements</li>
<li>Small screen Usability</li>
<li>Support for same web standards and rich content as Firefox</li>
<li>Partners, example products that use minimo??</li>
</ul>
</td>

<td>
<br>
<br>
<img src="minimo2.png"/>
</td>
</table>
</div>

<div class="slide">
<h1>Extensions</h1>
<ul>
<li>Open Source + Extensible Platform</li>
<li>Small addons to extend functionality</li>
<li>From new toolbar items to entire features</li>
<li>Over ## thousand extensions available <a href="http://addons.mozilla.org">http://addons.mozilla.org</a></li>
<li><a href="http://developer.mozilla.org/docs/Extensions">http://developer.mozilla.org/docs/Extensions</a></li>
</ul>
(what about a demo of tab preview...)
</div>
-->

<div class="slide">
<h1>Introduction</h1>
<ul>
<li>Gecko Overview</li>
<li>XUL</li>
<li>Using XBL to Extend XUL</li>
<li>SVG</li>
<li>Canvas</li>
<li>The Reveal Extension</li>
</ul>
</div>

<div class="slide">
<h1>What Is Gecko</h1>
<ul>
<li>The Mozilla Platform</li>
<li>Standards Compliant Web Layout Engine</li>
  <ul>
    <li>HTML 4.0, XHTML 1.1, XML 1.0, MathML</li>
    <li>CSS</li>
    <li>DOM</li>
    <li>SVG</li>
    <li>Canvas</li>
    <li>XForms</li>    
  </ul>
<li>Networking Module (http, ftp, cache)</li>
<li>Javascript Engine</li>
<li>Renders Application UI (XUL, XBL)</li>
</ul>
</div>

<div class="slide">
<h1>Gecko Overview</h1>
<center>
<img src="images/overview3.png"/>
</center>

  <div class="handout"></div>
  <div class="notes">
    <ul>
      <li>At the bottom, we have </li>
      <li>The core components of gecko</li>
      <li>XUL Runner</li>
      <li>At the top of the stack, the application layer: Thunderbird and Firefox</li>      
    </ul>
  </div>
</div>

<div class="slide">
<h1>Gecko Versions</h1>
<ul>
  <li>Separate Version Scheme</li>
  <li>Web Developers and Gecko Versions</li>
  <li>Thunderbird and Firefox 2 based on Gecko 1.8.1</li>
  <li>Thunderbird and Firefox 3 based on Gecko 1.9</li>
</ul>
</div>

<div class="slide">
<h1>Future Gecko Goals</h1>
<ul>
  <li>Enable next generation web content without requiring proprietary plugins like Flash</li>
  <li>Empowering Web 2.0 Applications (AJAX)</li>
  <li>Make it easy to build applications using the Mozilla Platform</li>
</ul>
</div>

<div class="slide">
<h1>Gecko 1.9</h1>
<ul>
<li>Graphics, Graphics, Graphics</li>
  <ul>
    <li>Graphics Back End powered by Cairo</li>
    <li>Modern Hardware-Accelerated Graphics</li>
    <li>SVG</li>
    <li>Canvas</li>
  </ul>
<li>JavaScript 2</li>
<li>Improving Web Applications</li>
  <ul>
    <li>Client-local storage</li>
    <li>Offline</li>
  </ul>
<li>XUL and XBL 2.0 Improvements</li>
<li>XUL Runner</li>
</ul>
</div>

<div class="slide">
<h1>What is XUL?</h1>
<ul>
<li>XML User Interface Language</li>
<li>A powerful language that lets quickly develop client software</li>
<li>Used by Firefox, Thunderbird and other projects</li>
<li>History</li>
</ul>
</div>

<div class="slide">
<h1>XUL Features</h1>
<ul>
<li>XML syntax</li>
<li>Rich toolkit of XUL widgets</li>
<li>Leverages Mozilla Platform Services: networking, file I/O, XMLHttpRequest, etc</li>
<li>Cross Platform UI</li>
<li>Scripting via Javascript</li>
<li>Accessibility</li>
<li>Localizability</li>
<li>Easy to learn (web developers who can do DHTML can write XUL)</li>
<li>Mature Toolkit, deployed to millions of users.</li>
</ul>
</div>

<div class="slide">
<h1>XUL Example</h1>
<a href="example.xul" target="_blank">Start Demo</a><br><br>
<center><img src="images/xul-example.png"/></center>
</div>

<div class="slide">
<h1>XUL Example II</h1>
<pre><code class="small">
&lt;?xml version="1.0"?&gt;
&lt;?xml-stylesheet href="chrome://global/skin"?&gt;

&lt;window id="simpleTest"
	xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
	title="A Simple XUL Test"&gt;
  &lt;script type="application/x-javascript" src="example.js"/&gt;

  &lt;vbox flex="1"&gt;
    &lt;listbox id="itemList" flex="1"&gt;
      &lt;listitem label="Item 1"/&gt;
      &lt;listitem label="Item 2"/&gt;
    &lt;/listbox&gt;
    &lt;hbox&gt;
      &lt;textbox id="labelField" flex="1" oninput="validateUserInput();"/&gt;
      &lt;button id="addButton" label="Add Item"
              disabled="true" oncommand="addItem();"/&gt;
    &lt;/hbox&gt;
  &lt;/vbox&gt;
&lt;/window&gt;
</code></pre>
</div>

<div class="slide">
<h1>XUL Example Continued III</h1>
<pre><code class="small">
function validateUserInput()
{
  // enable the add button if we have valid text
  if (document.getElementById('labelField').value)
    document.getElementById("addButton").disabled = false;
}

function addItem()
{
  // create a new listitem and add it to the list box
  var textInputField = document.getElementById('labelField');
  document.getElementById("itemList").appendItem(textInputField.value);
  textInputField.value = ""; // clear the text box
  document.getElementById("addButton").disabled = true;
}
</code></pre>
</div>

<div class="slide">
<h1>Extending XUL with XBL</h1>
<ul>
<li>Extensible Binding Language</li>
<li>Create new XUL widgets in terms of existing ones</li>
<li>Many XUL widgets are written in XBL using basic XUL Elements</li>
<li>Associate methods and properties with the binding</li>
</ul>
<br>
Consider a XUL button:
<br>
<center><img src="images/xul-button.png"/></center>
</div>

<div class="slide">
<h1>What is a XUL Button?</h1>
<pre><code class="small">
&lt;binding id="button"&gt;
  &lt;resources&gt;
    &lt;stylesheet src="chrome://global/skin/button.css"/&gt;
  &lt;/resources&gt;
  &lt;content&gt;
    &lt;xul:hbox&gt;
      &lt;children&gt;
        &lt;xul:image class="button-icon" xbl:inherits="src=image"/&gt;
        &lt;xul:label class="button-text" xbl:inherits="value=label,accesskey,crop"/&gt;      
      &lt;/children&gt;
    &lt;/xul:hbox&gt;
  &lt;/content&gt;
&lt;/binding&gt;
</code></pre>
</div>

<div class="slide">
<h1>What Is a XUL Button?</h1>
A little bit of CSS:
<pre><code class="small">
button {
  -moz-binding: url("chrome://global/content/bindings/button.xml#button");
}
</code></pre>

Back to our Example:

<pre><code class="small">
&lt;button label="Click Me!" image="chrome://browser/skin/Throbber-small.png"/&gt;
</code></pre>

</div>

<div class="slide">
<h1>Scalable Vector Graphics</h1>
<ul>
<li>W3C standard XML Vocabulary for vector graphics
  <ul>
    <li>Elements: rect, circle, etc
  </ul>
</li>
<li>Styleable via CSS</li>
<li>Part of the DOM</li>
<li>Event Handling is easy</li>
</ul>
</div>

<div class="slide">
<h1>SVG Status in Gecko</h1>
<ul>
<li>Support in Firefox 1.5 at SVG 1.1 level:</li>
  <ul>
    <li>Shapes, paths, transforms, clipping</li>
    <li>Gradients and Images</li>
    <li>Basic text</li>
    <li>Scripting and CSS Styling</li>
  </ul>
<li>Firefox 3 and Beyond
  <ul>
    <li>filters</li>
    <li>text pathing</li>
    <li>foreign object</li>
  </ul>
</li>
</ul>
</div>

<div class="slide">
  <h1>SVG Example</h1>
  <pre><code class="small">
&lt;<b>g</b> transform="translate(250,150)">
&lt;<b>g</b> transform="translate(-82,0)">
&lt;<b>rect</b> id="square" fill="red" x="-40" y="-40" width="80" height="80"
    onmousedown="doMouseDown(evt)"/>
&lt;/<b>g</b>>
&lt;<b>g</b> transform="translate(82,0)">
&lt;<b>circle</b> id="circle" fill="blue" cx="0" cy="0" r="40"
    onmousedown="doMouseDown(evt)"/>
&lt;/<b>g</b>>
&lt;<b>g</b> transform="translate(0,0)">
&lt;<b>polygon</b> id="triangle" fill="green" points="-40,40 0,-40 40,40"
  onmousedown="doMouseDown(evt)"/>
&lt;/<b>g</b>>
&lt;/<b>g</b>>
  </code></pre>

  <center><object width="400" height="200" data="images/svg-demo.xml" type="image/svg+xml"></object></center>
  <div class="handout"></div>
  <div class="notes">
    <ul>
      <li>Most content is specified through markup; can use CSS to style</li>
      <li>High level primitives such as circles, rects; generic polygons</li>
      <li>Event handling on individual elements through normal event mechanisms "for free"</li>
    </ul>
  </div>
</div>

<div class="slide">
<h1>SVG Limitations</h1>
<ul>
<li>Difficult to do data driven rendering (must manipulate the DOM)</li>
<li>Difficult to write by hand
<li>Complicated Specification
</ul>
</div>

<div class="slide">
<h1>Canvas</h1>
<ul>
<li>Modern 2D Graphics API for script to draw into</li>
<li>HTML element, can be used by XUL Applications and Web Developers</li>
<li>Supported in Firefox, Safari, Opera and others</li>
<li>No Document Object Model (DOM)</li>
</ul>
  <div class="notes">
    <ul>
      <li>Originally introduced by Apple in Safari</li>
      <li>Canvas is a programmable img element</li>
      <li>Gives a surface with a specified size to draw into</li>
      <li>Part of the WHATWG Web Apps Spec</li>      
    </ul>
  </div>
</div>

<div class="slide" onslideshow="canvas1_start()" >
  <h1><tt>&lt;canvas&gt;</tt> 2D</h1>
<pre><code class="small">
var ctx = canvas.getContext("<i>2d</i>");
with (ctx) {
  <b>translate</b>(canvas.width / 2, canvas.height / 2);

  <b>save</b>(); <b>translate</b>(-82, 0);
  <b>fillStyle</b> = "<em>red</em>";
  <b>fillRect</b>(-40, -40, 80, 80);
  <b>restore</b>();

  <b>save</b>(); <b>translate</b>(0, 0);
  <b>fillStyle</b> = "<em>green</em>";
  <b>beginPath</b>();
  <b>moveTo</b>(-40, 40);
  <b>lineTo</b>(0, -40);
  <b>lineTo</b>(40, 40);
  <b>fill</b>(); <b>restore</b>();

  <b>save</b>(); <b>translate</b>(82, 0);
  <b>fillStyle</b> = "<em>blue</em>";
  <b>arc</b>(0, 0, 40, 0, 2 * Math.PI, false);
  <b>fill</b>(); <b>restore</b>();
}
</pre></code>

<div class="canvas-example">
  <canvas style="border: 2px solid black;" id="canvas1" width="400" height="200"></canvas>
</div>

<div class="handout"></div>
  <div class="notes">
    <ul>
      <li>Canvas supports multiple contexts; first one is for 2D drawing</li>
      <li>Fully programmatic API for drawing; the only element in the page markup is canvas</li>
      <li>Supports 2D affine transforms (scaling, translation, rotation)</li>
      <li>Core operation is path strokes/fills</li>
	    <li>Path build-up uses commands similar to PostScript (moveto, lineto, arc, closepath)
    </ul>
  </div>
</div>

<div class="slide" onslideshow="canvas2_start()">
<h1><tt>&lt;canvas&gt;</tt> 2D: Patterns</h1>
<pre><code class="small">
var pat = ctx.createPattern(img, "<em>repeat</em>");
with (ctx) {
  <b>fillStyle</b> = pat;
  <b>beginPath</b>();          <i>// triangle</i>

  <b>moveTo</b>(10, 90);
  <b>lineTo</b>(50, 10);
  <b>lineTo</b>(90, 90);
  <b>lineTo</b>(10, 90);
  <b>stroke</b>();

  <b>rotate</b>(Math.PI/4);
  <b>scale</b>(.2, .2);
  <b>fill</b>();
}
</pre></code>

<div class="canvas-example">
  <img style="visibility: hidden;" id="mozilla-image" src="images/moz-head.png"/>
  <canvas style="border: 2px solid black;" id="canvas2" width="400" height="400"/>
</div>

<div class="handout"></div>
<div class="notes">
  <ul>
    <li>Drawing images</li>
    <li>Single images using drawImage</li>
    <li>Resuable patterns using createPattern (including image and gradient patterns)</li>
    <li>canvases can be used as images!</li>
    <li>offscreen images</li>
  </ul>
</div>
</div> <!-- /slide -->

<div class="slide" onslideshow="canvas3_start()" onslidehide="canvas3_stop()">
<h1><tt>&lt;canvas&gt;</tt> 2D: Animation</h1>
<pre><code class="small">
with (ctx) {
  var pat = <b>createPattern</b>(img, "<em>repeat</em>");
  <b>fillStyle</b> = pat;
  <b>triangle</b>(ctx); <i>// create our triangle path</i>

  <b>stroke</b>();

  <b>setInterval</b>(function () {
      <i>// fill with transparent white, to fade out</i>
      <b>ctx.fillStyle</b> = "<em>rgba(255, 255, 255, 0.5)</em>";
      <b>ctx.fill</b>();
      <i>// rotate and fill with our pattern</i>

      <b>ctx.rotate</b>(Math.PI/20);
      <b>ctx.fillStyle</b> = pat;
      <b>ctx.fill</b>();
    }, 100);
}
</pre></code>
  <div class="canvas-example">
    <canvas style="border: 2px solid black;" id="canvas3" width="400" height="400"/>
  </div>

  <div class="handout"></div>
  <div class="notes">
	  <ul>
	    <li>Animation in canvas is done through DOM timers, just like DHTML</li>
	    <li>You redraw the scene (or portion of the scene) that needs to animate</li>
	    <li>In this example, fade out using a transparent white wash</li>
	    <li>Then redraw using a new rotation</li>
	  </ul>
    </div>
</div> <!-- /slide -->

<div class="slide">
<h1>Canvas Limitations</h1>
<ul>
  <li>No direct text rendering support</li>
  <li>No DOM Presence</li>
    <ul>
      <li>Must redraw to make a change</li>
      <li>But drawing is quick</li>
    </ul>
</ul>
</div>

<div class="slide">
  <h1><tt>&lt;canvas&gt;</tt> Examples: 3D</h1>
  <center>
    <img width="70%" src="images/ss-3d.png"/><br/>
    <span><a href="" target="_new" rel="external">3D Canvas Context</a><br/>
  </center>

  <div class="handout"></div>
  <div class="notes">
    <li>3D Canvas Context</li>
    <li>drawWindow to create a texture from a web page</li>
  </div>
</div> <!-- /slide -->

<div class="slide">
<h1>The Reveal Extension</h1>
<br>
Putting it all together with the Reveal extension
<br>
<br>
<center><img src="images/reveal.png"/></center>
</div>

<div class="slide">
<h1>Breaking down Reveal</h1>
<b>Tab Preview Widget</b>
<pre><code class="small">
  &lt;vbox&gt;
    &lt;html:canvas id="previewCanvas"/&gt;
    &lt;label id="previewLabel" crop="end"/&gt;
  &lt;/vbox&gt;
</code></pre>
<b>Drawing the Tab Preview</b>
<pre><code class="small">
var ctx = canvas.getContext("2d");
ctx.save();
ctx.scale(x/width, y/height);

// this.browser.contentWindow is the content window
// for the current tab. We're going to draw that tab onto
// our canvas, scaling it down to the width and height
// of our canvas element.
ctx.drawWindow(this.browser.contentWindow,
               sleft, stop, width, height, "rgb(255,0,255)");
ctx.restore();
</code></pre>
</div>

<div class="slide">
<h1>In Summary</h1>
<ul>
<li>Exciting Things Ahead for Gecko and open standards on the web</li>
<li>Empowering Web Developers (SVG, Canvas)</li>
<li>Empowering AJAX Web Applications</li>
<li>Empowering Application Development (XUL Runner)</li>
</ul>
</div>

<div class="slide">
<h1>Questions</h1>
<br>
<br>
<br>
<br>
<br>
<br>
<center>Questions and Answers</center>
</div>

<div class="slide">
<h1>Resources and Acknowledgments</h1>
<br>
<b></b>Additional Resources:</b>
<ul>
<li><a href="http://www.xulplanet.com/">http://www.xulplanet.com/</a></li>
<li><a href="http://developer.mozilla.org/">http://developer.mozilla.org/</a></li>
<li><a href="https://addons.mozilla.org/firefox/1942/">https://addons.mozilla.org/firefox/1942/</a></li>
</ul>

<br>
<b>Thanks To:</b>
<ul>
  <li>Ben Goodger</li>
  <li>Vladimir Vuki&#263;evi&#263;</li>
  <li>Robert O'Callahan</li>
  <li>Michael Vu: Extension Author for Reveal</li>
</ul>
</div>

<!-- class="incremental" "show-first" -->    
</div> <!-- presentation -->
</body>
</html>
